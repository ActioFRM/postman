{
  "info": {
    "_postman_id": "8075a23a-2d12-4bd4-a97b-e7c51e12cec7",
    "name": "Rule-078 Jenkins",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "pacs 002",
      "item": [
        {
          "name": "transaction 1",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const jsonData = pm.response.json();",
                  "",
                  "var req = JSON.parse(request.data);",
                  "",
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"should not have errors\", function () {",
                  "    pm.expect(jsonData).not.to.have.property('errors')",
                  "});",
                  "",
                  "pm.test(\"should be a valid transaction\", function () {",
                  "    pm.expect(jsonData.message).to.eql(\"Transaction is valid\");",
                  "});",
                  "",
                  "pm.test(\"should send to data preparation successfully\", function () {",
                  "    pm.expect(jsonData.sent).to.eql(true);",
                  "});",
                  "",
                  "pm.test(\"should have the same outgoing and incoming json\", function () {",
                  "    pm.expect(jsonData.data).to.eql(req);",
                  "});"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "pm.sendRequest({\r",
                  "    url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "    method: 'POST',\r",
                  "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "    body: {\r",
                  "        mode: 'raw',\r",
                  "        raw: JSON.stringify({\r",
                  "            query: `FOR doc IN networkConfiguration\r",
                  "                    FILTER doc.active == true\r",
                  "                    UPDATE doc WITH { active: false } IN networkConfiguration`\r",
                  "        })\r",
                  "    }\r",
                  "});\r",
                  "\r",
                  "var req = JSON.parse(request.data);\r",
                  "//console.log(req.FIToFIPmtSts.GrpHdr.MsgId);\r",
                  "let e2eID = JSON.stringify(req.FIToFIPmtSts.GrpHdr.MsgId);\r",
                  "\r",
                  "//console.log(e2eID)\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "//console.log(e2eID)\r",
                  "\r",
                  "pm.collectionVariables.set(\"EndToEndId\", e2eID);\r",
                  "\r",
                  "const networkMaps = [\r",
                  "{\r",
                  "       \"key\": \"104\",\r",
                  "       \"active\": true,\r",
                  "       \"cfg\": \"2.0.0\",\r",
                  "       \"messages\": [\r",
                  "            {\r",
                  "                \"id\": \"004@1.0.0\",\r",
                  "                \"host\": \"http://gateway.openfaas:8080/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "                \"cfg\": \"1.0.0\",\r",
                  "                \"txTp\": \"pacs.002.001.12\",\r",
                  "                \"channels\": [\r",
                  "                    {\r",
                  "                        \"id\": \"001@1.0.0\",\r",
                  "                        \"host\": \"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "                        \"cfg\": \"1.0.0\",\r",
                  "                        \"typologies\": [\r",
                  "                            {\r",
                  "                                \"id\": \"999@1.0.0\",\r",
                  "                                \"host\": \"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                                \"cfg\": \"1.0.0\",\r",
                  "                                \"rules\": [\r",
                  "                                    {\r",
                  "                                        \"id\": \"078@1.0.0\",\r",
                  "                                        \"host\": \"http://gateway.openfaas:8080/function/off-rule-078-rel-1-0-0\",\r",
                  "                                        \"cfg\": \"1.0.0\"\r",
                  "                                    }\r",
                  "                                ]\r",
                  "                            }\r",
                  "                        ]\r",
                  "                    }\r",
                  "                ]\r",
                  "            }\r",
                  "        ]\r",
                  "    }\r",
                  "]\r",
                  "\r",
                  "\r",
                  "setTimeout(checkStatusCode, 2);\r",
                  "\r",
                  "    function checkStatusCode() {\r",
                  "\r",
                  "        pm.sendRequest({\r",
                  "            url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "            method: 'POST',\r",
                  "            header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "            body: {\r",
                  "                mode: 'raw',\r",
                  "                raw: JSON.stringify({\r",
                  "                    query: `FOR networkmap IN ${JSON.stringify(networkMaps)}\r",
                  "                            INSERT {_id: networkmap._id, _key: networkmap.key, active: networkmap.active, cfg: networkmap.cfg, messages: networkmap.messages} INTO networkConfiguration\r",
                  "                            OPTIONS { overwrite: true }`\r",
                  "                })\r",
                  "            }\r",
                  "        });\r",
                  "    }\r",
                  ""
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"TxTp\": \"pacs.002.001.12\",\n  \"FIToFIPmtSts\": {\n    \"GrpHdr\": {\n      \"MsgId\": \"a26a10-0c31-4564-94f6-ar353\",\n      \"CreDtTm\": \"2022-02-08T07:24:48.000Z\"\n    },\n    \"TxInfAndSts\": {\n      \"OrgnlInstrId\": \"2f68ae16-467a-4ac4-ba32-eb5\",\n      \"OrgnlEndToEndId\": \"baf005dc-c223-4be1-8e5a-ed72ba472b\",\n      \"TxSts\": \"ACCC\",\n      \"ChrgsInf\": [\n        {\n          \"Amt\": {\n            \"Amt\": 157605510200862,\n            \"Ccy\": \"USD\"\n          },\n          \"Agt\": {\n            \"FinInstnId\": {\n              \"ClrSysMmbId\": {\n                \"MmbId\": \"dfsp001\"\n              }\n            }\n          }\n        },\n        {\n          \"Amt\": {\n            \"Amt\": 15918156530287100,\n            \"Ccy\": \"USD\"\n          },\n          \"Agt\": {\n            \"FinInstnId\": {\n              \"ClrSysMmbId\": {\n                \"MmbId\": \"dfsp001\"\n              }\n            }\n          }\n        },\n        {\n          \"Amt\": {\n            \"Amt\": 15918156530287100,\n            \"Ccy\": \"USD\"\n          },\n          \"Agt\": {\n            \"FinInstnId\": {\n              \"ClrSysMmbId\": {\n                \"MmbId\": \"dfsp002\"\n              }\n            }\n          }\n        }\n      ],\n      \"AccptncDtTm\": \"2021-11-03T07:24:47.000Z\",\n      \"InstgAgt\": {\n        \"FinInstnId\": {\n          \"ClrSysMmbId\": {\n            \"MmbId\": \"dfsp001\"\n          }\n        }\n      },\n      \"InstdAgt\": {\n        \"FinInstnId\": {\n          \"ClrSysMmbId\": {\n            \"MmbId\": \"dfsp002\"\n          }\n        }\n      }\n    }\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://gateway.openfaas:8080/function/off-transaction-monitoring-service-rel-1-0-0/transfer-response",
              "protocol": "http",
              "host": ["gateway", "openfaas"],
              "port": "8080",
              "path": [
                "function",
                "off-transaction-monitoring-service-rel-1-0-0",
                "transfer-response"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Arango db check transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "var Header = require('postman-collection').Header;\r",
                  "pm.request.headers.append(Header.create(`Bearer ${pm.globals.get(\"arangoToken\")}`, 'Authorization'));\r",
                  "//console.log(\"received end to end id for above request \",pm.collectionVariables.get(\"EndToEndId\")); \r",
                  "\r",
                  "pm.environment.set(\"query\", JSON.stringify(\r",
                  "      `\r",
                  "      for transaction In transactions\r",
                  "       FILTER transaction.transaction.FIToFIPmtSts.GrpHdr.MsgId == \r",
                  "       `+pm.collectionVariables.get(\"EndToEndId\")+`\r",
                  "       return transaction ` \r",
                  "));\r",
                  "\r",
                  "//console.log(pm.environment.get(\"query\"))\r",
                  " "
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();\r",
                  "var req = JSON.parse(request.data);\r",
                  "\r",
                  "//console.log(\"Result: \", jsonData.result)\r",
                  "\r",
                  "\r",
                  "pm.test(\"Status code is 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  " \r",
                  "pm.test(\"check that there is actual data received back \", function () {\r",
                  "    pm.expect(jsonData.result).to.not.eql([]);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"check that the report status is ALRT \", function () {\r",
                  "    pm.expect(jsonData.result[0].report.status).to.eql(\"ALRT\");\r",
                  "});\r",
                  "\r",
                  "pm.test(\"check that the rule result is withrawal \", function () {\r",
                  "    pm.expect(jsonData.result[0].report.tadpResult.channelResult[0].typologyResult[0].ruleResults[0].result).to.eql(true);\r",
                  "    pm.expect(jsonData.result[0].report.tadpResult.channelResult[0].typologyResult[0].ruleResults[0].subRuleRef).to.eql(\".01\");\r",
                  "    pm.expect(jsonData.result[0].report.tadpResult.channelResult[0].typologyResult[0].ruleResults[0].reason).to.eql(\"The transaction is identified as a cash withdrawal\");\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"query\": \"for transaction In transactions FILTER transaction.transaction.FIToFIPmtSts.GrpHdr.MsgId ==  {{EndToEndId}} return transaction \"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://arango.development:8529/_db/transactionHistory/_api/cursor",
              "protocol": "http",
              "host": ["arango", "development"],
              "port": "8529",
              "path": ["_db", "transactionHistory", "_api", "cursor"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "pain 013",
      "item": [
        {
          "name": "transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const networkMaps = [\r",
                  "    {\r",
                  "   \"key\":\"55\",\r",
                  "   \"active\":true,\r",
                  "   \"cfg\":\"2.1.1\",\r",
                  "   \"messages\":[\r",
                  "      {\r",
                  "         \"id\":\"002@1.0\",\r",
                  "         \"host\":\"http://gateway.openfaas:8080\",\r",
                  "         \"cfg\":\"1.0\",\r",
                  "         \"txTp\":\"pain.013.001.09\",\r",
                  "         \"channels\":[\r",
                  "            {\r",
                  "               \"id\":\"001@1.0\",\r",
                  "               \"host\":\"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "               \"cfg\":\"1.0\",\r",
                  "               \"typologies\":[\r",
                  "                  {\r",
                  "                     \"id\":\"028@1.0.\",\r",
                  "                     \"host\":\"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                     \"cfg\":\"1.0\",\r",
                  "                     \"rules\":[\r",
                  "                        {\r",
                  "                           \"id\":\"028@1.0.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-028\",\r",
                  "                           \"cfg\":\"1.0.0\"\r",
                  "                        }\r",
                  "                     ]\r",
                  "                  },\r",
                  "                  {\r",
                  "                     \"id\":\"029@1.0\",\r",
                  "                     \"host\":\"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                     \"cfg\":\"1.0\",\r",
                  "                     \"rules\":[\r",
                  "                        {\r",
                  "                           \"id\":\"028@1.0.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-028\",\r",
                  "                           \"cfg\":\"1.0.0\"\r",
                  "                        }\r",
                  "                     ]\r",
                  "                  }\r",
                  "               ]\r",
                  "            },\r",
                  "            {\r",
                  "               \"id\":\"002@1.0\",\r",
                  "               \"host\":\"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "               \"cfg\":\"1.0\",\r",
                  "               \"typologies\":[\r",
                  "                  {\r",
                  "                     \"id\":\"030@1.0\",\r",
                  "                     \"host\":\"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                     \"cfg\":\"1.0.0\",\r",
                  "                     \"rules\":[\r",
                  "                        {\r",
                  "                           \"id\":\"028@1.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-028\",\r",
                  "                           \"cfg\":\"1.0.0\"\r",
                  "                        }\r",
                  "                     ]\r",
                  "                  },\r",
                  "                  {\r",
                  "                     \"id\":\"031@1.0\",\r",
                  "                     \"host\":\"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                     \"cfg\":\"1.0\",\r",
                  "                     \"rules\":[\r",
                  "                        {\r",
                  "                           \"id\":\"028@1.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-028\",\r",
                  "                           \"cfg\":\"1.0\"\r",
                  "                        }\r",
                  "                     ]\r",
                  "                  }\r",
                  "               ]\r",
                  "            }\r",
                  "         ]\r",
                  "      }\r",
                  "   ]\r",
                  "}\r",
                  "]\r",
                  "\r",
                  "pm.sendRequest({\r",
                  "    url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "    method: 'POST',\r",
                  "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "    body: {\r",
                  "        mode: 'raw',\r",
                  "        raw: JSON.stringify({\r",
                  "            query: `FOR doc IN networkConfiguration\r",
                  "                    FILTER doc.active == true\r",
                  "                    UPDATE doc WITH { active: false } IN networkConfiguration`\r",
                  "        })\r",
                  "    }\r",
                  "});\r",
                  "\r",
                  "\r",
                  "pm.sendRequest({\r",
                  "    url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "    method: 'POST',\r",
                  "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "    body: {\r",
                  "        mode: 'raw',\r",
                  "        raw: JSON.stringify({\r",
                  "            query: `FOR networkmap IN ${JSON.stringify(networkMaps)}\r",
                  "                    INSERT {_id: networkmap._id, _key: networkmap.key, active: networkmap.active, cfg: networkmap.cfg, messages: networkmap.messages} INTO networkConfiguration\r",
                  "                    OPTIONS { overwrite: true }`\r",
                  "        })\r",
                  "    }\r",
                  "});\r",
                  "var req = JSON.parse(request.data);\r",
                  "//console.log(req.CdtrPmtActvtnReq.GrpHdrMsgId);\r",
                  "let e2eID = JSON.stringify(req.CdtrPmtActvtnReq.GrpHdr.MsgId);\r",
                  "\r",
                  "//console.log(e2eID)\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "//console.log(e2eID)\r",
                  "\r",
                  "pm.collectionVariables.set(\"EndToEndId\", e2eID);\r",
                  "\r",
                  ""
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"TxTp\": \"pain.013.001.09\",\r\n    \"CdtrPmtActvtnReq\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"994443699119746c5be7dfb5516ba6fwwe0\",\r\n            \"CreDtTm\": \"2021-10-21T14:02:54.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Horatio Sam Ford\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1981-04-11\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27721299138\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-721299138\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"XpryDt\": {\r\n                \"DtTm\": \"2021-10-21\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"2021-10-21T14:02:54.000Z\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"2021-10-07\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"zz\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"ZZ\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"+27721299138\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27-721299138\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"+27721299138\"\r\n                        },\r\n                        \"Nm\": \"PASSPORT\"\r\n                    }\r\n                }\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"Horatio Ford\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"baf005dc-c223-4be1-8e5a-ed72ba472b\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27782722305\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"PyeeRcvAmt\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 4906747824834590.33,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrFee\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 49067478248345.9,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrComssn\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 0,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1675\",\r\n                            \"Long\": \"39.059\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://gateway.openfaas:8080/function/off-transaction-monitoring-service-rel-1-0-0/quoteReply",
              "protocol": "http",
              "host": ["gateway", "openfaas"],
              "port": "8080",
              "path": [
                "function",
                "off-transaction-monitoring-service-rel-1-0-0",
                "quoteReply"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Arango db check transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "var Header = require('postman-collection').Header;\r",
                  "pm.request.headers.append(Header.create(`Bearer ${pm.globals.get(\"arangoToken\")}`, 'Authorization'));"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();\r",
                  "var req = JSON.parse(request.data);\r",
                  "\r",
                  "\r",
                  "pm.test(\"Status code is 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  " \r",
                  "pm.test(\"check that there is actual data received back \", function () {\r",
                  "    pm.expect(jsonData.result).to.not.eql([]);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"query\": \"for transaction In transactionHistory FILTER transaction.CdtrPmtActvtnReq.GrpHdr.MsgId ==  {{EndToEndId}} return transaction \"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://arango.development:8529/_db/transactionHistory/_api/cursor",
              "protocol": "http",
              "host": ["arango", "development"],
              "port": "8529",
              "path": ["_db", "transactionHistory", "_api", "cursor"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "pain 001",
      "item": [
        {
          "name": "transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "pm.sendRequest({\r",
                  "    url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "    method: 'POST',\r",
                  "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "    body: {\r",
                  "        mode: 'raw',\r",
                  "        raw: JSON.stringify({\r",
                  "            query: `FOR doc IN networkConfiguration\r",
                  "                    FILTER doc.active == true\r",
                  "                    UPDATE doc WITH { active: false } IN networkConfiguration`\r",
                  "        })\r",
                  "    }\r",
                  "});\r",
                  "\r",
                  "var req = JSON.parse(request.data);\r",
                  "//console.log(req.CstmrCdtTrfInitn.GrpHdr.MsgId);\r",
                  "let e2eID = JSON.stringify(req.CstmrCdtTrfInitn.GrpHdr.MsgId);\r",
                  "\r",
                  "//console.log(e2eID)\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "//console.log(e2eID)\r",
                  "\r",
                  "pm.collectionVariables.set(\"EndToEndId\", e2eID);\r",
                  "\r",
                  "const networkMaps = [\r",
                  "    {\r",
                  "    \"key\": \"102\",\r",
                  "    \"active\": true,\r",
                  "    \"cfg\": \"1.0.0\",\r",
                  "   \"messages\":[\r",
                  "      {\r",
                  "         \"id\":\"001@1.0\",\r",
                  "         \"host\":\"http://gateway.openfaas:8080/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "         \"cfg\":\"1.0\",\r",
                  "         \"txTp\":\"pain.001.001.11\",\r",
                  "         \"channels\":[\r",
                  "            {\r",
                  "               \"id\":\"001@1.0\",\r",
                  "               \"host\":\"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r",
                  "               \"cfg\":\"1.0\",\r",
                  "               \"typologies\":[\r",
                  "                  {\r",
                  "                     \"id\":\"028@1.0\",\r",
                  "                     \"host\":\"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r",
                  "                     \"cfg\":\"1.0\",\r",
                  "                     \"rules\":[\r",
                  "                        {\r",
                  "                           \"id\":\"003@1.0.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-003\",\r",
                  "                           \"cfg\":\"1.0.0\"\r",
                  "                        },\r",
                  "                        {\r",
                  "                           \"id\":\"028@1.0.0\",\r",
                  "                           \"host\":\"http://gateway.openfaas:8080/function/off-rule-028\",\r",
                  "                           \"cfg\":\"1.0.0\"\r",
                  "                        }\r",
                  "                     ]\r",
                  "                  }\r",
                  "               ]\r",
                  "            }\r",
                  "         ]\r",
                  "      }\r",
                  "   ]\r",
                  "}\r",
                  "]\r",
                  "\r",
                  "pm.sendRequest({\r",
                  "    url: 'http://arango.development:8529/_db/networkmap/_api/cursor',\r",
                  "    method: 'POST',\r",
                  "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
                  "    body: {\r",
                  "        mode: 'raw',\r",
                  "        raw: JSON.stringify({\r",
                  "            query: `FOR networkmap IN ${JSON.stringify(networkMaps)}\r",
                  "                    INSERT {_id: networkmap._id, _key: networkmap.key, active: networkmap.active, cfg: networkmap.cfg, messages: networkmap.messages} INTO networkConfiguration\r",
                  "                    OPTIONS { overwrite: true }`\r",
                  "        })\r",
                  "    }\r",
                  "});\r",
                  ""
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"TxTp\": \"pain.001.001.11\",\r\n    \"CstmrCdtTrfInitn\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"1q1488f2-bb8d-4859-bbb3-ee38a688\",\r\n            \"CreDtTm\": \"2021-11-12T10:18:43.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Colin Cameron\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1951-04-28\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": { \r\n                            \"Id\": \"+27718877119\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-718877119\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"6fba567b-bc2b-4d66-80a8-2434dbd2\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"Dt\": \"2021-11-12\",\r\n                \"DtTm\": \"2021-11-12T10:18:43.000Z\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"Colin Cameron\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1951-04-28\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27718877119\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-718877119\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27718877119\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"MSISDN\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Colin Cameron\"\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp001\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"baf005dc-c223-4be1-8e5a-ed72ba472b\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"WITHDRAWAL\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\":123123,\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\":123123,\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"David Owen Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1962-01-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27781569879\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-781569879\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27781569879\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"David Klein\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 53317231546556900.46 from Colin to David\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"Dbtr\": {\r\n                                \"FrstNm\": \"Colin\",\r\n                                \"MddlNm\": \"\",\r\n                                \"LastNm\": \"Cameron\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"Cdtr\": {\r\n                                \"FrstNm\": \"David\",\r\n                                \"MddlNm\": \"Owen\",\r\n                                \"LastNm\": \"Klein\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"DbtrFinSvcsPrvdrFees\": {\r\n                                \"Ccy\": \"USD\",\r\n                                \"Amt\": 123123\r\n                            },\r\n                            \"Xprtn\": \"2021-11-12T10:23:43.000Z\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"InitrTp\": \"CONSUMER\",\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.0187\",\r\n                            \"Long\": \"37.4368\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://gateway.openfaas:8080/function/off-transaction-monitoring-service/execute",
              "protocol": "http",
              "host": ["gateway", "openfaas"],
              "port": "8080",
              "path": [
                "function",
                "off-transaction-monitoring-service",
                "execute"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Arango db check transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "var Header = require('postman-collection').Header;\r",
                  "pm.request.headers.append(Header.create(`Bearer ${pm.globals.get(\"arangoToken\")}`, 'Authorization'));"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();\r",
                  "var req = JSON.parse(request.data);\r",
                  "\r",
                  "pm.test(\"Status code is 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"check that there is actual data received back \", function () {\r",
                  "    //console.log(jsonData.result)\r",
                  "    pm.expect(jsonData.result).to.not.eql([]);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"query\": \"for transaction In transactions FILTER transaction.transaction.CstmrCdtTrfInitn.GrpHdr.MsgId == {{EndToEndId}} return transaction \"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://arango.development:8529/_db/transactionHistory/_api/cursor",
              "protocol": "http",
              "host": ["arango", "development"],
              "port": "8529",
              "path": ["_db", "transactionHistory", "_api", "cursor"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "pacs 008",
      "item": [
        {
          "name": "transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "var req = JSON.parse(request.data);\r",
                  "//console.log(req.FIToFICstmrCdt.GrpHdr.MsgId);\r",
                  "\r",
                  "if (pm.collectionVariables.get(\"EndToEndId\") == JSON.stringify(`\\\"`\r",
                  "    + req.FIToFICstmrCdt.GrpHdr.MsgId\r",
                  "    + `\\\"`)) {\r",
                  "    console.error(\"previos e2e id\", pm.collectionVariables.get(\"EndToEndId\"), \"is the same as current \", JSON.stringify(`\\\"`\r",
                  "        + req.FIToFICstmrCdt.GrpHdr.MsgId\r",
                  "        + `\\\"`));\r",
                  "}\r",
                  "\r",
                  "let e2eID = JSON.stringify(req.FIToFICstmrCdt.GrpHdr.MsgId);\r",
                  "\r",
                  "//console.log(e2eID)\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "e2eID = e2eID.replace(\"\\\"\", \"'\")\r",
                  "//console.log(e2eID)\r",
                  "\r",
                  "pm.collectionVariables.set(\"EndToEndId\", e2eID);\r",
                  "\r",
                  "//console.log(\"e2e id set to \", pm.collectionVariables.get(\"EndToEndId\"))"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"TxTp\": \"pacs.008.001.10\",\r\n    \"FIToFICstmrCdt\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"dd663gf0-6cbc-40e2-bd9a-8a44stb\",\r\n            \"CreDtTm\": \"2021-11-23T12:30:21.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"SttlmInf\": {\r\n                \"SttlmMtd\": \"CLRG\"\r\n            }\r\n        },\r\n        \"CdtTrfTxInf\": {\r\n            \"PmtId\": {\r\n                \"InstrId\": \"557bf747-12f1-4983-9004-10a\",\r\n                \"EndToEndId\": \"baf005dc-c223-4be1-8e5a-ed72ba472b\"\r\n            },\r\n            \"IntrBkSttlmAmt\": {\r\n                \"Amt\": {\r\n                    \"Amt\": 14315.99,\r\n                    \"Ccy\": \"USD\"\r\n                }\r\n            },\r\n            \"InstdAmt\": {\r\n                \"Amt\": {\r\n                    \"Amt\": 14315.99,\r\n                    \"Ccy\": \"USD\"\r\n                }\r\n            },\r\n            \"ChrgBr\": \"DEBT\",\r\n            \"ChrgsInf\": {\r\n                \"Amt\": {\r\n                    \"Amt\": 141.74,\r\n                    \"Ccy\": \"USD\"\r\n                },\r\n                \"Agt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Evan Morgan O'Connell\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1965-01-27\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27887145476\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-887145476\"\r\n                }\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"Evan Morgan O'Connell\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1965-01-27\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27887145476\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-887145476\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27887145476\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"MSISDN\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Evan O'Connell\"\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp001\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp002\"\r\n                    }\r\n                }\r\n            },\r\n            \"Cdtr\": {\r\n                \"Nm\": \"Colin Owen Bryce\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1995-01-03\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27875136965\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-875136965\"\r\n                }\r\n            },\r\n            \"CdtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27875136965\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"MSISDN\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Colin Bryce\"\r\n            },\r\n            \"Purp\": {\r\n                \"Cd\": \"MP2P\"\r\n            }\r\n        },\r\n        \"RgltryRptg\": {\r\n            \"Dtls\": {\r\n                \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                \"Cd\": \"100\"\r\n            }\r\n        },\r\n        \"RmtInf\": {\r\n            \"Ustrd\": \"Payment of USD 14174.25 from Evan to Colin\"\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"Xprtn\": \"2021-11-23T12:35:17.000Z\"\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://gateway.openfaas:8080function/off-transaction-monitoring-service-rel-1-0-0/transfer",
              "protocol": "http",
              "host": ["gateway", "openfaas"],
              "port": "8080function",
              "path": [
                "off-transaction-monitoring-service-rel-1-0-0",
                "transfer"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Arango db check transaction 1",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "var Header = require('postman-collection').Header;\r",
                  "pm.request.headers.append(Header.create(`Bearer ${pm.globals.get(\"arangoToken\")}`, 'Authorization'));"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();\r",
                  "//console.log(jsonData)\r",
                  "var req = JSON.parse(request.data);\r",
                  "\r",
                  "\r",
                  "pm.test(\"Status code is 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  " \r",
                  "pm.test(\"check that there is actual data received back \", function () {\r",
                  "    pm.expect(jsonData.result).to.not.eql([]);\r",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"query\": \"for transaction In transactionHistory FILTER transaction.FIToFICstmrCdt.GrpHdr.MsgId ==  {{EndToEndId}} return transaction \"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://arango.development:8529/_db/transactionHistory/_api/cursor",
              "protocol": "http",
              "host": ["arango", "development"],
              "port": "8529",
              "path": ["_db", "transactionHistory", "_api", "cursor"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Test Scenario 1",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "// 1 - Type = WITHDRAWAL TRUE (sub-rule ref .01) (The transaction is identified as a cash withdrawal)\r",
              "\r",
              "const now = new Date().getTime();\r",
              "\r",
              "pm.globals.set(\"now\", new Date().toISOString());\r",
              "\r",
              "const ruleConfig = [{\r",
              "    \"id\": \"078@1.0.0\",\r",
              "    \"cfg\": \"1.0.0\",\r",
              "    \"config\": {\r",
              "        \"case\": [\r",
              "            {\r",
              "                \"value\": \"WITHDRAWAL\",\r",
              "                \"subRuleRef\": \".01\",\r",
              "                \"outcome\": true,\r",
              "                \"reason\": \"The transaction is identified as a cash withdrawal\"\r",
              "            },\r",
              "            {\r",
              "                \"subRuleRef\": \".00\",\r",
              "                \"outcome\": false,\r",
              "                \"reason\": \"The transaction type is non-indicative for this typology\"\r",
              "            },\r",
              "        ]\r",
              "    }\r",
              "}]\r",
              "\r",
              "const pacs002Transactions = [\r",
              "{\r",
              "    \"TxTp\": \"pacs.002.001.12\",\r",
              "    \"FIToFIPmtSts\": {\r",
              "      \"GrpHdr\": {\r",
              "        \"MsgId\": \"30bea71c5ayfd5d8d57f94b2a40e9789\",\r",
              "        \"CreDtTm\": new Date(now).toISOString()\r",
              "      },\r",
              "      \"TxInfAndSts\": {\r",
              "        \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2255\",\r",
              "        \"OrgnlEndToEndId\": \"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\",\r",
              "        \"TxSts\": \"ACCC\",\r",
              "        \"ChrgsInf\": [\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 307.14,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp001\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          },\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 153.57,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp001\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          },\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 30.71,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp002\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          }\r",
              "        ],\r",
              "        \"AccptncDtTm\": \"2021-12-03T15:24:26.000Z\",\r",
              "        \"InstgAgt\": {\r",
              "          \"FinInstnId\": {\r",
              "            \"ClrSysMmbId\": {\r",
              "              \"MmbId\": \"dfsp001\"\r",
              "            }\r",
              "          }\r",
              "        },\r",
              "        \"InstdAgt\": {\r",
              "          \"FinInstnId\": {\r",
              "            \"ClrSysMmbId\": {\r",
              "              \"MmbId\": \"dfsp002\"\r",
              "            }\r",
              "          }\r",
              "        }\r",
              "      }\r",
              "    }\r",
              "  }]\r",
              "\r",
              "\r",
              "const pain001Transactions = [\r",
              "{\r",
              "   \"TxTp\":\"pain.001.001.11\",\r",
              "   \"CstmrCdtTrfInitn\":{\r",
              "      \"GrpHdr\":{\r",
              "         \"MsgId\":\"2nfe98292ec04bf29b5d40ba998648gh\",\r",
              "         \"CreDtTm\": new Date(new Date(now - 30000).getTime()).toISOString(),\r",
              "         \"NbOfTxs\":1,\r",
              "         \"InitgPty\":{\r",
              "            \"Nm\":\"Ivan Reese Russel-Klein\",\r",
              "            \"Id\":{\r",
              "               \"PrvtId\":{\r",
              "                  \"DtAndPlcOfBirth\":{\r",
              "                     \"BirthDt\":\"1967-11-23\",\r",
              "                     \"CityOfBirth\":\"Unknown\",\r",
              "                     \"CtryOfBirth\":\"ZZ\"\r",
              "                  },\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"CtctDtls\":{\r",
              "               \"MobNb\":\"\"\r",
              "            }\r",
              "         }\r",
              "      },\r",
              "      \"PmtInf\":{\r",
              "         \"PmtInfId\":\"2c516801007642dfb892944dde1cf845897\",\r",
              "         \"PmtMtd\":\"TRA\",\r",
              "         \"ReqdAdvcTp\":{\r",
              "            \"DbtAdvc\":{\r",
              "               \"Cd\":\"ADWD\",\r",
              "               \"Prtry\":\"Advice with transaction details\"\r",
              "            }\r",
              "         },\r",
              "         \"ReqdExctnDt\":{\r",
              "            \"Dt\":\"2021-10-07\",\r",
              "            \"DtTm\":\"2021-10-07T09:25:31.000Z\"\r",
              "         },\r",
              "         \"Dbtr\":{\r",
              "            \"Nm\":\"Ivan Reese Russel-Klein\",\r",
              "            \"Id\":{\r",
              "               \"PrvtId\":{\r",
              "                  \"DtAndPlcOfBirth\":{\r",
              "                     \"BirthDt\":\"1967-11-23\",\r",
              "                     \"CityOfBirth\":\"Unknown\",\r",
              "                     \"CtryOfBirth\":\"ZZ\"\r",
              "                  },\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"CtctDtls\":{\r",
              "               \"MobNb\":\"\"\r",
              "            }\r",
              "         },\r",
              "         \"DbtrAcct\":{\r",
              "            \"Id\":{\r",
              "               \"Othr\":{\r",
              "                  \"Id\":\"03aeae97e5e2263c8c22bc0dec615b13ee6c90b6cf2dc0ffee72bcce9c66a19e\",\r",
              "                  \"SchmeNm\":{\r",
              "                     \"Prtry\":\"PASSPORT\"\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"Nm\":\"Ivan Russel-Klein\"\r",
              "         },\r",
              "         \"DbtrAgt\":{\r",
              "            \"FinInstnId\":{\r",
              "               \"ClrSysMmbId\":{\r",
              "                  \"MmbId\":\"dfsp001\"\r",
              "               }\r",
              "            }\r",
              "         },\r",
              "         \"CdtTrfTxInf\":{\r",
              "            \"PmtId\":{\r",
              "               \"EndToEndId\":\"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\"\r",
              "            },\r",
              "            \"PmtTpInf\":{\r",
              "               \"CtgyPurp\":{\r",
              "                  \"Prtry\":\"WITHDRAWAL\"\r",
              "               }\r",
              "            },\r",
              "            \"Amt\":{\r",
              "               \"InstdAmt\":{\r",
              "                  \"Amt\":{\r",
              "                     \"Amt\":\"50431891779910900\",\r",
              "                     \"Ccy\":\"USD\"\r",
              "                  }\r",
              "               },\r",
              "               \"EqvtAmt\":{\r",
              "                  \"Amt\":{\r",
              "                     \"Amt\":\"50431891779910900\",\r",
              "                     \"Ccy\":\"USD\"\r",
              "                  },\r",
              "                  \"CcyOfTrf\":\"USD\"\r",
              "               }\r",
              "            },\r",
              "            \"ChrgBr\":\"DEBT\",\r",
              "            \"CdtrAgt\":{\r",
              "               \"FinInstnId\":{\r",
              "                  \"ClrSysMmbId\":{\r",
              "                     \"MmbId\":\"dfsp002\"\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"Cdtr\":{\r",
              "               \"Nm\":\"\",\r",
              "               \"Id\":{\r",
              "                  \"PrvtId\":{\r",
              "                     \"DtAndPlcOfBirth\":{\r",
              "                        \"BirthDt\":\"1923-04-26\",\r",
              "                        \"CityOfBirth\":\"\",\r",
              "                        \"CtryOfBirth\":\"\"\r",
              "                     },\r",
              "                     \"Othr\":{\r",
              "                        \"Id\":\"\",\r",
              "                        \"SchmeNm\":{\r",
              "                           \"Prtry\":\"MSISDN\"\r",
              "                        }\r",
              "                     }\r",
              "                  }\r",
              "               },\r",
              "               \"CtctDtls\":{\r",
              "                  \"MobNb\":\"\"\r",
              "               }\r",
              "            },\r",
              "            \"CdtrAcct\":{\r",
              "               \"Id\":{\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"03aeae97e5e2263c8c22bc0dec615b13ee6c90b6cf2dc0ffee72bcce9c66a23c\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               },\r",
              "               \"Nm\":\"April Adamson\"\r",
              "            },\r",
              "            \"Purp\":{\r",
              "               \"Cd\":\"MP2P\"\r",
              "            },\r",
              "            \"RgltryRptg\":{\r",
              "               \"Dtls\":{\r",
              "                  \"Tp\":\"BALANCE OF PAYMENTS\",\r",
              "                  \"Cd\":\"100\"\r",
              "               }\r",
              "            },\r",
              "            \"RmtInf\":{\r",
              "               \"Ustrd\":\"Payment of USD 49932566118723700.89 from Ivan to April\"\r",
              "            },\r",
              "            \"SplmtryData\":{\r",
              "               \"Envlp\":{\r",
              "                  \"Doc\":{\r",
              "                     \"Cdtr\":{\r",
              "                        \"FrstNm\":\"Ivan\",\r",
              "                        \"MddlNm\":\"Reese\",\r",
              "                        \"LastNm\":\"Russel-Klein\",\r",
              "                        \"MrchntClssfctnCd\":\"BLANK\"\r",
              "                     },\r",
              "                     \"Dbtr\":{\r",
              "                        \"FrstNm\":\"\",\r",
              "                        \"MddlNm\":\"\",\r",
              "                        \"LastNm\":\"\",\r",
              "                        \"MrchntClssfctnCd\":\"BLANK\"\r",
              "                     },\r",
              "                     \"DbtrFinSvcsPrvdrFees\":{\r",
              "                        \"Ccy\":\"USD\",\r",
              "                        \"Amt\":\"499325661187237\"\r",
              "                     },\r",
              "                     \"Xprtn\":\"2021-10-07T09:30:31.000Z\"\r",
              "                  }\r",
              "               }\r",
              "            }\r",
              "         }\r",
              "      },\r",
              "      \"SplmtryData\":{\r",
              "         \"Envlp\":{\r",
              "            \"Doc\":{\r",
              "               \"InitgPty\":{\r",
              "                  \"InitrTp\":\"CONSUMER\",\r",
              "                  \"Glctn\":{\r",
              "                     \"Lat\":\"-3.4541\",\r",
              "                     \"Long\":\"38.4238\"\r",
              "                  }\r",
              "               }\r",
              "            }\r",
              "         }\r",
              "      }\r",
              "   }\r",
              "}]\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR transaction IN ${JSON.stringify(pacs002Transactions)}\r",
              "                    INSERT {_key: transaction.FIToFIPmtSts.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFIPmtSts: transaction.FIToFIPmtSts} INTO transactionHistory\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR transaction IN ${JSON.stringify(pain001Transactions)}\r",
              "                    INSERT {_key: transaction.CstmrCdtTrfInitn.GrpHdr.MsgId, TxTp: transaction.TxTp, CstmrCdtTrfInitn: transaction.CstmrCdtTrfInitn} INTO transactionHistory\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/Configuration/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
              "                    INSERT {_key: \"078\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});"
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "// 1 - Type = WITHDRAWAL TRUE (sub-rule ref .01) (The transaction is identified as a cash withdrawal)\r",
              "\r",
              "const jsonData = pm.response.json();\r",
              "const req = JSON.parse(request.data);\r",
              "\r",
              "const transactions = [\r",
              "    \"30bea71c5ayfd5d8d57f94b2a40e9789\",\r",
              "    \"2nfe98292ec04bf29b5d40ba998648gh\",\r",
              "]\r",
              "\r",
              "\r",
              "pm.test(\"Status code is 200\", function () {\r",
              "    pm.response.to.have.status(200);\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule result of true\", function () {\r",
              "    pm.expect(jsonData.ruleResult.result).to.be.eql(true);\r",
              "\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule reason of 'The transaction is identified as a cash withdrawal' \", function () {\r",
              "    pm.expect(jsonData.ruleResult.reason).to.be.eql(\"The transaction is identified as a cash withdrawal\");\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule subRuleRef of '.01' \", function () {\r",
              "    pm.expect(jsonData.ruleResult.subRuleRef).to.be.eql(\".01\");\r",
              "});\r",
              "\r",
              "pm.test(\"Remove Seed Data from DB\", function () {\r",
              "    pm.sendRequest({\r",
              "        url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "        method: 'POST',\r",
              "        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "        body: {\r",
              "            mode: 'raw',\r",
              "            raw: JSON.stringify({\r",
              "                query: `FOR transaction IN ${JSON.stringify(transactions)}\r",
              "                        REMOVE { _key: transaction } IN transactionHistory\r",
              "                        OPTIONS { ignoreErrors: true }`\r",
              "            })\r",
              "        }\r",
              "    })\r",
              "});\r",
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"transaction\": {\r\n    \"TxTp\": \"pacs.002.001.12\",\r\n    \"FIToFIPmtSts\": {\r\n      \"GrpHdr\": {\r\n        \"MsgId\": \"30bea71c5a054978ad0da7f94b2a40e9789\",\r\n        \"CreDtTm\": \"{{now}}\"\r\n      },\r\n      \"TxInfAndSts\": {\r\n        \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2255\",\r\n        \"OrgnlEndToEndId\": \"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\",\r\n        \"TxSts\": \"ACCC\",\r\n        \"ChrgsInf\": [\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 307.14,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp001\"\r\n                }\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 153.57,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp001\"\r\n                }\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 30.71,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp002\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        \"AccptncDtTm\": \"2021-12-03T15:24:26.000Z\",\r\n        \"InstgAgt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp001\"\r\n            }\r\n          }\r\n        },\r\n        \"InstdAgt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp002\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"networkMap\": {\r\n    \"messages\": [\r\n      {\r\n        \"id\": \"004@1.0.0\",\r\n        \"host\": \"http://gateway.openfaas:8080/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"txTp\": \"pacs.002.001.12\",\r\n        \"channels\": [\r\n          {\r\n            \"id\": \"001@1.0.0\",\r\n            \"host\": \"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n            \"cfg\": \"1.0.0\",\r\n            \"typologies\": [\r\n              {\r\n                \"id\": \"999@1.0.0\",\r\n                \"host\": \"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"rules\": [\r\n                  {\r\n                    \"id\": \"078@1.0.0\",\r\n                    \"host\": \"http://gateway.openfaas:8080/function/off-rule-028-rel-1-0-0\",\r\n                    \"cfg\": \"1.0.0\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://gateway.openfaas:8080/function/off-rule-078-rel-1-0-0/execute",
          "protocol": "http",
          "host": ["gateway", "openfaas"],
          "port": "8080",
          "path": ["function", "off-rule-078-rel-1-0-0", "execute"]
        }
      },
      "response": []
    },
    {
      "name": "Test Scenario 2",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "// 2 - Type = ANYTHING TRUE (sub-rule ref .00) (The transaction type is non-indicative for this typology)\r",
              "\r",
              "const now = new Date().getTime();\r",
              "\r",
              "pm.globals.set(\"now\", new Date().toISOString());\r",
              "\r",
              "const ruleConfig = [{\r",
              "    \"id\": \"078@1.0.0\",\r",
              "    \"cfg\": \"1.0.0\",\r",
              "    \"config\": {\r",
              "        \"case\": [\r",
              "            {\r",
              "                \"value\": \"WITHDRAWAL\",\r",
              "                \"subRuleRef\": \".01\",\r",
              "                \"outcome\": true,\r",
              "                \"reason\": \"The transaction is identified as a cash withdrawal\"\r",
              "            },\r",
              "            {\r",
              "                \"subRuleRef\": \".00\",\r",
              "                \"outcome\": false,\r",
              "                \"reason\": \"The transaction type is non-indicative for this typology\"\r",
              "            },\r",
              "        ]\r",
              "    }\r",
              "}]\r",
              "\r",
              "const pacs002Transactions = [\r",
              "{\r",
              "    \"TxTp\": \"pacs.002.001.12\",\r",
              "    \"FIToFIPmtSts\": {\r",
              "      \"GrpHdr\": {\r",
              "        \"MsgId\": \"30bea71c5ayfd5d8d57f94b2a40e9789\",\r",
              "        \"CreDtTm\": new Date(now).toISOString()\r",
              "      },\r",
              "      \"TxInfAndSts\": {\r",
              "        \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2255\",\r",
              "        \"OrgnlEndToEndId\": \"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\",\r",
              "        \"TxSts\": \"ACCC\",\r",
              "        \"ChrgsInf\": [\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 307.14,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp001\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          },\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 153.57,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp001\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          },\r",
              "          {\r",
              "            \"Amt\": {\r",
              "              \"Amt\": 30.71,\r",
              "              \"Ccy\": \"USD\"\r",
              "            },\r",
              "            \"Agt\": {\r",
              "              \"FinInstnId\": {\r",
              "                \"ClrSysMmbId\": {\r",
              "                  \"MmbId\": \"dfsp002\"\r",
              "                }\r",
              "              }\r",
              "            }\r",
              "          }\r",
              "        ],\r",
              "        \"AccptncDtTm\": \"2021-12-03T15:24:26.000Z\",\r",
              "        \"InstgAgt\": {\r",
              "          \"FinInstnId\": {\r",
              "            \"ClrSysMmbId\": {\r",
              "              \"MmbId\": \"dfsp001\"\r",
              "            }\r",
              "          }\r",
              "        },\r",
              "        \"InstdAgt\": {\r",
              "          \"FinInstnId\": {\r",
              "            \"ClrSysMmbId\": {\r",
              "              \"MmbId\": \"dfsp002\"\r",
              "            }\r",
              "          }\r",
              "        }\r",
              "      }\r",
              "    }\r",
              "  }]\r",
              "\r",
              "\r",
              "const pain001Transactions = [\r",
              "{\r",
              "   \"TxTp\":\"pain.001.001.11\",\r",
              "   \"CstmrCdtTrfInitn\":{\r",
              "      \"GrpHdr\":{\r",
              "         \"MsgId\":\"2nfe98292ec04bf29b5d40ba998648gh\",\r",
              "         \"CreDtTm\": new Date(new Date(now - 30000).getTime()).toISOString(),\r",
              "         \"NbOfTxs\":1,\r",
              "         \"InitgPty\":{\r",
              "            \"Nm\":\"Ivan Reese Russel-Klein\",\r",
              "            \"Id\":{\r",
              "               \"PrvtId\":{\r",
              "                  \"DtAndPlcOfBirth\":{\r",
              "                     \"BirthDt\":\"1967-11-23\",\r",
              "                     \"CityOfBirth\":\"Unknown\",\r",
              "                     \"CtryOfBirth\":\"ZZ\"\r",
              "                  },\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"CtctDtls\":{\r",
              "               \"MobNb\":\"\"\r",
              "            }\r",
              "         }\r",
              "      },\r",
              "      \"PmtInf\":{\r",
              "         \"PmtInfId\":\"2c516801007642dfb892944dde1cf845897\",\r",
              "         \"PmtMtd\":\"TRA\",\r",
              "         \"ReqdAdvcTp\":{\r",
              "            \"DbtAdvc\":{\r",
              "               \"Cd\":\"ADWD\",\r",
              "               \"Prtry\":\"Advice with transaction details\"\r",
              "            }\r",
              "         },\r",
              "         \"ReqdExctnDt\":{\r",
              "            \"Dt\":\"2021-10-07\",\r",
              "            \"DtTm\":\"2021-10-07T09:25:31.000Z\"\r",
              "         },\r",
              "         \"Dbtr\":{\r",
              "            \"Nm\":\"Ivan Reese Russel-Klein\",\r",
              "            \"Id\":{\r",
              "               \"PrvtId\":{\r",
              "                  \"DtAndPlcOfBirth\":{\r",
              "                     \"BirthDt\":\"1967-11-23\",\r",
              "                     \"CityOfBirth\":\"Unknown\",\r",
              "                     \"CtryOfBirth\":\"ZZ\"\r",
              "                  },\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"CtctDtls\":{\r",
              "               \"MobNb\":\"\"\r",
              "            }\r",
              "         },\r",
              "         \"DbtrAcct\":{\r",
              "            \"Id\":{\r",
              "               \"Othr\":{\r",
              "                  \"Id\":\"03aeae97e5e2263c8c22bc0dec615b13ee6c90b6cf2dc0ffee72bcce9c66a19e\",\r",
              "                  \"SchmeNm\":{\r",
              "                     \"Prtry\":\"PASSPORT\"\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"Nm\":\"Ivan Russel-Klein\"\r",
              "         },\r",
              "         \"DbtrAgt\":{\r",
              "            \"FinInstnId\":{\r",
              "               \"ClrSysMmbId\":{\r",
              "                  \"MmbId\":\"dfsp001\"\r",
              "               }\r",
              "            }\r",
              "         },\r",
              "         \"CdtTrfTxInf\":{\r",
              "            \"PmtId\":{\r",
              "               \"EndToEndId\":\"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\"\r",
              "            },\r",
              "            \"PmtTpInf\":{\r",
              "               \"CtgyPurp\":{\r",
              "                  \"Prtry\":\"ANYTHING\"\r",
              "               }\r",
              "            },\r",
              "            \"Amt\":{\r",
              "               \"InstdAmt\":{\r",
              "                  \"Amt\":{\r",
              "                     \"Amt\":\"50431891779910900\",\r",
              "                     \"Ccy\":\"USD\"\r",
              "                  }\r",
              "               },\r",
              "               \"EqvtAmt\":{\r",
              "                  \"Amt\":{\r",
              "                     \"Amt\":\"50431891779910900\",\r",
              "                     \"Ccy\":\"USD\"\r",
              "                  },\r",
              "                  \"CcyOfTrf\":\"USD\"\r",
              "               }\r",
              "            },\r",
              "            \"ChrgBr\":\"DEBT\",\r",
              "            \"CdtrAgt\":{\r",
              "               \"FinInstnId\":{\r",
              "                  \"ClrSysMmbId\":{\r",
              "                     \"MmbId\":\"dfsp002\"\r",
              "                  }\r",
              "               }\r",
              "            },\r",
              "            \"Cdtr\":{\r",
              "               \"Nm\":\"\",\r",
              "               \"Id\":{\r",
              "                  \"PrvtId\":{\r",
              "                     \"DtAndPlcOfBirth\":{\r",
              "                        \"BirthDt\":\"1923-04-26\",\r",
              "                        \"CityOfBirth\":\"\",\r",
              "                        \"CtryOfBirth\":\"\"\r",
              "                     },\r",
              "                     \"Othr\":{\r",
              "                        \"Id\":\"\",\r",
              "                        \"SchmeNm\":{\r",
              "                           \"Prtry\":\"MSISDN\"\r",
              "                        }\r",
              "                     }\r",
              "                  }\r",
              "               },\r",
              "               \"CtctDtls\":{\r",
              "                  \"MobNb\":\"\"\r",
              "               }\r",
              "            },\r",
              "            \"CdtrAcct\":{\r",
              "               \"Id\":{\r",
              "                  \"Othr\":{\r",
              "                     \"Id\":\"03aeae97e5e2263c8c22bc0dec615b13ee6c90b6cf2dc0ffee72bcce9c66a23c\",\r",
              "                     \"SchmeNm\":{\r",
              "                        \"Prtry\":\"MSISDN\"\r",
              "                     }\r",
              "                  }\r",
              "               },\r",
              "               \"Nm\":\"April Adamson\"\r",
              "            },\r",
              "            \"Purp\":{\r",
              "               \"Cd\":\"MP2P\"\r",
              "            },\r",
              "            \"RgltryRptg\":{\r",
              "               \"Dtls\":{\r",
              "                  \"Tp\":\"BALANCE OF PAYMENTS\",\r",
              "                  \"Cd\":\"100\"\r",
              "               }\r",
              "            },\r",
              "            \"RmtInf\":{\r",
              "               \"Ustrd\":\"Payment of USD 49932566118723700.89 from Ivan to April\"\r",
              "            },\r",
              "            \"SplmtryData\":{\r",
              "               \"Envlp\":{\r",
              "                  \"Doc\":{\r",
              "                     \"Cdtr\":{\r",
              "                        \"FrstNm\":\"Ivan\",\r",
              "                        \"MddlNm\":\"Reese\",\r",
              "                        \"LastNm\":\"Russel-Klein\",\r",
              "                        \"MrchntClssfctnCd\":\"BLANK\"\r",
              "                     },\r",
              "                     \"Dbtr\":{\r",
              "                        \"FrstNm\":\"\",\r",
              "                        \"MddlNm\":\"\",\r",
              "                        \"LastNm\":\"\",\r",
              "                        \"MrchntClssfctnCd\":\"BLANK\"\r",
              "                     },\r",
              "                     \"DbtrFinSvcsPrvdrFees\":{\r",
              "                        \"Ccy\":\"USD\",\r",
              "                        \"Amt\":\"499325661187237\"\r",
              "                     },\r",
              "                     \"Xprtn\":\"2021-10-07T09:30:31.000Z\"\r",
              "                  }\r",
              "               }\r",
              "            }\r",
              "         }\r",
              "      },\r",
              "      \"SplmtryData\":{\r",
              "         \"Envlp\":{\r",
              "            \"Doc\":{\r",
              "               \"InitgPty\":{\r",
              "                  \"InitrTp\":\"CONSUMER\",\r",
              "                  \"Glctn\":{\r",
              "                     \"Lat\":\"-3.4541\",\r",
              "                     \"Long\":\"38.4238\"\r",
              "                  }\r",
              "               }\r",
              "            }\r",
              "         }\r",
              "      }\r",
              "   }\r",
              "}]\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR transaction IN ${JSON.stringify(pacs002Transactions)}\r",
              "                    INSERT {_key: transaction.FIToFIPmtSts.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFIPmtSts: transaction.FIToFIPmtSts} INTO transactionHistory\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR transaction IN ${JSON.stringify(pain001Transactions)}\r",
              "                    INSERT {_key: transaction.CstmrCdtTrfInitn.GrpHdr.MsgId, TxTp: transaction.TxTp, CstmrCdtTrfInitn: transaction.CstmrCdtTrfInitn} INTO transactionHistory\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});\r",
              "\r",
              "pm.sendRequest({\r",
              "    url: 'http://arango.development:8529/_db/Configuration/_api/cursor',\r",
              "    method: 'POST',\r",
              "    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "    body: {\r",
              "        mode: 'raw',\r",
              "        raw: JSON.stringify({\r",
              "            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
              "                    INSERT {_key: \"078\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
              "                    OPTIONS { overwrite: true }`\r",
              "        })\r",
              "    }\r",
              "});"
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "// 1 - Type = ANYTHING FALSE (sub-rule ref .00) (The transaction type is non-indicative for this typology)\r",
              "\r",
              "const jsonData = pm.response.json();\r",
              "const req = JSON.parse(request.data);\r",
              "\r",
              "const transactions = [\r",
              "    \"30bea71c5ayfd5d8d57f94b2a40e9789\",\r",
              "    \"2nfe98292ec04bf29b5d40ba998648gh\",\r",
              "]\r",
              "\r",
              "pm.test(\"Remove Seed Data from DB\", function () {\r",
              "    pm.sendRequest({\r",
              "        url: 'http://arango.development:8529/_db/transactionHistory/_api/cursor',\r",
              "        method: 'POST',\r",
              "        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
              "        body: {\r",
              "            mode: 'raw',\r",
              "            raw: JSON.stringify({\r",
              "                query: `FOR transaction IN ${JSON.stringify(transactions)}\r",
              "                        REMOVE { _key: transaction } IN transactionHistory\r",
              "                        OPTIONS { ignoreErrors: true }`\r",
              "            })\r",
              "        }\r",
              "    })\r",
              "});\r",
              "\r",
              "pm.test(\"Status code is 200\", function () {\r",
              "    pm.response.to.have.status(200);\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule result of false\", function () {\r",
              "    pm.expect(jsonData.ruleResult.result).to.be.eql(false);\r",
              "\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule reason of 'The transaction type is non-indicative for this typology' \", function () {\r",
              "    pm.expect(jsonData.ruleResult.reason).to.be.eql(\"The transaction type is non-indicative for this typology\");\r",
              "});\r",
              "\r",
              "pm.test(\"should have rule subRuleRef of '.00' \", function () {\r",
              "    pm.expect(jsonData.ruleResult.subRuleRef).to.be.eql(\".00\");\r",
              "});\r",
              "\r",
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"transaction\": {\r\n    \"TxTp\": \"pacs.002.001.12\",\r\n    \"FIToFIPmtSts\": {\r\n      \"GrpHdr\": {\r\n        \"MsgId\": \"30bea71c5a054978ad0da7f94b2a40e9789\",\r\n        \"CreDtTm\": \"{{now}}\"\r\n      },\r\n      \"TxInfAndSts\": {\r\n        \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2255\",\r\n        \"OrgnlEndToEndId\": \"0a2d6e99a000c04f304bdc09e47d44ef532fa9e7\",\r\n        \"TxSts\": \"ACCC\",\r\n        \"ChrgsInf\": [\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 307.14,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp001\"\r\n                }\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 153.57,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp001\"\r\n                }\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"Amt\": {\r\n              \"Amt\": 30.71,\r\n              \"Ccy\": \"USD\"\r\n            },\r\n            \"Agt\": {\r\n              \"FinInstnId\": {\r\n                \"ClrSysMmbId\": {\r\n                  \"MmbId\": \"dfsp002\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        \"AccptncDtTm\": \"2021-12-03T15:24:26.000Z\",\r\n        \"InstgAgt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp001\"\r\n            }\r\n          }\r\n        },\r\n        \"InstdAgt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp002\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"networkMap\": {\r\n    \"messages\": [\r\n      {\r\n        \"id\": \"004@1.0.0\",\r\n        \"host\": \"http://gateway.openfaas:8080/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"txTp\": \"pacs.002.001.12\",\r\n        \"channels\": [\r\n          {\r\n            \"id\": \"001@1.0.0\",\r\n            \"host\": \"http://gateway.openfaas:8080/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n            \"cfg\": \"1.0.0\",\r\n            \"typologies\": [\r\n              {\r\n                \"id\": \"999@1.0.0\",\r\n                \"host\": \"http://gateway.openfaas:8080/function/off-typology-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"rules\": [\r\n                  {\r\n                    \"id\": \"078@1.0.0\",\r\n                    \"host\": \"http://gateway.openfaas:8080/function/off-rule-028-rel-1-0-0\",\r\n                    \"cfg\": \"1.0.0\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "http://gateway.openfaas:8080/function/off-rule-078-rel-1-0-0/execute",
          "protocol": "http",
          "host": ["gateway", "openfaas"],
          "port": "8080",
          "path": ["function", "off-rule-078-rel-1-0-0", "execute"]
        }
      },
      "response": []
    }
  ]
}
