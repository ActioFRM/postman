{
	"info": {
		"_postman_id": "ffa86d71-1984-4bf9-b615-bfbab2eb9fc2",
		"name": "Data Preperation",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Pain001",
			"item": [
				{
					"name": "AM-634 Test 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Incoming & Outgoing messages match\", function () {\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.senderIdentityInStore).to.be.false;\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(\"b51ec535-ee48-4575-b6a9-ead2955b8069\");\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Test debtor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.DbtrAcct.Id.Othr.Id).to.eq(\"6793245d1b205bf4edb97ab17b6164b160893c433fc10ad4fdc618721edc9604\");\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.DbtrAcct.Id.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Test creditor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.Id).to.eq(\"7ef6a22de95d2a898f387c67256a8632890f2889887d44022cf555362fac436b\");\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"TxTp\": \"pain.001.001.11\",\r\n    \"CstmrCdtTrfInitn\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"2669e349-500d-44ba-9e27-7767a16608a0\",\r\n            \"CreDtTm\": \"2021-10-07T09:25:31.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"Dt\": \"2021-10-07\",\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27783078685\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"PASSPORT\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Ivan Russel-Klein\"\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp001\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"b51ec535-ee48-4575-b6a9-ead2955b8069\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27782722305\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"Cdtr\": {\r\n                                \"FrstNm\": \"Ivan\",\r\n                                \"MddlNm\": \"Reese\",\r\n                                \"LastNm\": \"Russel-Klein\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"Dbtr\": {\r\n                                \"FrstNm\": \"April\",\r\n                                \"MddlNm\": \"Sam\",\r\n                                \"LastNm\": \"Adamson\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"DbtrFinSvcsPrvdrFees\": {\r\n                                \"Ccy\": \"USD\",\r\n                                \"Amt\": \"499325661187237\"\r\n                            },\r\n                            \"Xprtn\": \"2021-10-07T09:30:31.000Z\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"InitrTp\": \"CONSUMER\",\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1291\",\r\n                            \"Long\": \"39.0006\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				},
				{
					"name": "AM-634 Test 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().CstmrCdtTrfInitn.PmtInf.DbtrAcct.Id.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    pm.test(`Check if debtor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    pm.test(`Check if creditor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"TxTp\": \"pain.001.001.11\",\r\n    \"CstmrCdtTrfInitn\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"2669e349-500d-44ba-9e27-7767a16608a0\",\r\n            \"CreDtTm\": \"2021-10-07T09:25:31.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"Dt\": \"2021-10-07\",\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"{{$guid}}\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"PASSPORT\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Ivan Russel-Klein\"\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp001\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"b51ec535-ee48-4575-b6a9-ead2955b8069\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"{{$guid}}\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"Cdtr\": {\r\n                                \"FrstNm\": \"Ivan\",\r\n                                \"MddlNm\": \"Reese\",\r\n                                \"LastNm\": \"Russel-Klein\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"Dbtr\": {\r\n                                \"FrstNm\": \"April\",\r\n                                \"MddlNm\": \"Sam\",\r\n                                \"LastNm\": \"Adamson\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"DbtrFinSvcsPrvdrFees\": {\r\n                                \"Ccy\": \"USD\",\r\n                                \"Amt\": \"499325661187237\"\r\n                            },\r\n                            \"Xprtn\": \"2021-10-07T09:30:31.000Z\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"InitrTp\": \"CONSUMER\",\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1291\",\r\n                            \"Long\": \"39.0006\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				},
				{
					"name": "Test 1 & 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Incoming & Outgoing messages match\", function () {\r",
									"    const responseJson = pm.response.json();\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.senderIdentityInStore).to.be.false;\r",
									"    pm.expect(responseJson.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(\"b51ec535-ee48-4575-b6a9-ead2955b8069\");\r",
									"    pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"TxTp\": \"pain.001.001.11\",\r\n    \"CstmrCdtTrfInitn\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"2669e349-500d-44ba-9e27-7767a16608a0\",\r\n            \"CreDtTm\": \"2021-10-07T09:25:31.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"Dt\": \"2021-10-07\",\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1967-11-23\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27783078685\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"PASSPORT\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Nm\": \"Ivan Russel-Klein\"\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"dfsp001\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"b51ec535-ee48-4575-b6a9-ead2955b8069\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": \"50431891779910900\",\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27782722305\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"Cdtr\": {\r\n                                \"FrstNm\": \"Ivan\",\r\n                                \"MddlNm\": \"Reese\",\r\n                                \"LastNm\": \"Russel-Klein\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"Dbtr\": {\r\n                                \"FrstNm\": \"April\",\r\n                                \"MddlNm\": \"Sam\",\r\n                                \"LastNm\": \"Adamson\",\r\n                                \"MrchntClssfctnCd\": \"BLANK\"\r\n                            },\r\n                            \"DbtrFinSvcsPrvdrFees\": {\r\n                                \"Ccy\": \"USD\",\r\n                                \"Amt\": \"499325661187237\"\r\n                            },\r\n                            \"Xprtn\": \"2021-10-07T09:30:31.000Z\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"InitrTp\": \"CONSUMER\",\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1291\",\r\n                            \"Long\": \"39.0006\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Pain013",
			"item": [
				{
					"name": "AM-621 Test 1 and 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Incoming & Outgoing messages match\", function () {\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.senderIdentityInStore).to.be.false;\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.PmtInf.DbtrAgt.FinInstnId.ClrSysMmbId.MmbId).to.eq(\"Horatio Ford\");\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Test debtor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.PmtInf.DbtrAcct.Id.Othr.Id).to.eq(\"26ca7a4ee092fe1c3b8bac4d50d4595d49814a395f0ec832ae795f93480316b0\");\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.PmtInf.DbtrAcct.Id.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Test creditor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.PmtInf.CdtTrfTxInf.CdtrAcct.Id.Othr.Id).to.eq(\"d9f6186b6d511137614809165c19d02be1bed6b29d1912db8a610e19208614eb\");\r",
									"    pm.expect(responseJson.CdtrPmtActvtnReq.PmtInf.CdtTrfTxInf.CdtrAcct.Id.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"TxTp\": \"pain.013.001.09\",\r\n    \"CdtrPmtActvtnReq\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"2669e349-500d-44ba-9e27-7767a16608a0\",\r\n            \"CreDtTm\": \"2021-10-21T14:02:54.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Horatio Sam Ford\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1981-04-11\",\r\n                            \"CityOfBirth\": \"Unknownnn\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27721299138\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-721299138\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"XpryDt\": {\r\n                \"DtTm\": \"2021-10-21\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"2021-10-21T14:02:54.000Z\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"2021-10-07\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"zz\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"ZZ\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"+27721299138\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27-7212967538\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"+2772145369138\"\r\n                        },\r\n                        \"Nm\": \"PASSPORT\"\r\n                    }\r\n                }\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"Horatio Ford\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27782722305\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783564685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"PyeeRcvAmt\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 4906747824834590.33,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrFee\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 49067478248345.9,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrComssn\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 0,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1675\",\r\n                            \"Long\": \"39.059\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				},
				{
					"name": "AM-621 Test 3",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().CdtrPmtActvtnReq.PmtInf.DbtrAcct.Id.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    pm.test(`Check if debtor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().CdtrPmtActvtnReq.PmtInf.CdtTrfTxInf.CdtrAcct.Id.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    console.log(err, res)\r",
									"    pm.test(`Check if creditor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"TxTp\": \"pain.013.001.09\",\r\n    \"CdtrPmtActvtnReq\": {\r\n        \"GrpHdr\": {\r\n            \"MsgId\": \"2669e349-500d-44ba-9e27-7767a16608a0\",\r\n            \"CreDtTm\": \"2021-10-21T14:02:54.000Z\",\r\n            \"NbOfTxs\": 1,\r\n            \"InitgPty\": {\r\n                \"Nm\": \"Horatio Sam Ford\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"1981-04-11\",\r\n                            \"CityOfBirth\": \"Unknownnn\",\r\n                            \"CtryOfBirth\": \"ZZ\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27721299138\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-721299138\"\r\n                }\r\n            }\r\n        },\r\n        \"PmtInf\": {\r\n            \"PmtInfId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\",\r\n            \"PmtMtd\": \"TRA\",\r\n            \"ReqdAdvcTp\": {\r\n                \"DbtAdvc\": {\r\n                    \"Cd\": \"ADWD\",\r\n                    \"Prtry\": \"Advice with transaction details\"\r\n                }\r\n            },\r\n            \"ReqdExctnDt\": {\r\n                \"DtTm\": \"2021-10-07T09:25:31.000Z\"\r\n            },\r\n            \"XpryDt\": {\r\n                \"DtTm\": \"2021-10-21\"\r\n            },\r\n            \"Dbtr\": {\r\n                \"Nm\": \"2021-10-21T14:02:54.000Z\",\r\n                \"Id\": {\r\n                    \"PrvtId\": {\r\n                        \"DtAndPlcOfBirth\": {\r\n                            \"BirthDt\": \"2021-10-07\",\r\n                            \"CityOfBirth\": \"Unknown\",\r\n                            \"CtryOfBirth\": \"zz\"\r\n                        },\r\n                        \"Othr\": {\r\n                            \"Id\": \"ZZ\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"+27721299138\"\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"CtctDtls\": {\r\n                    \"MobNb\": \"+27-783078685\"\r\n                }\r\n            },\r\n            \"DbtrAcct\": {\r\n                \"Id\": {\r\n                    \"Othr\": {\r\n                        \"Id\": \"+27-7212967538\",\r\n                        \"SchmeNm\": {\r\n                            \"Prtry\": \"+2772145369138\"\r\n                        },\r\n                        \"Nm\": \"PASSPORT\"\r\n                    }\r\n                }\r\n            },\r\n            \"DbtrAgt\": {\r\n                \"FinInstnId\": {\r\n                    \"ClrSysMmbId\": {\r\n                        \"MmbId\": \"Horatio Ford\"\r\n                    }\r\n                }\r\n            },\r\n            \"CdtTrfTxInf\": {\r\n                \"PmtId\": {\r\n                    \"EndToEndId\": \"b51ec534-ee48-4575-b6a9-ead2955b8069\"\r\n                },\r\n                \"PmtTpInf\": {\r\n                    \"CtgyPurp\": {\r\n                        \"Prtry\": \"TRANSFER\"\r\n                    }\r\n                },\r\n                \"Amt\": {\r\n                    \"InstdAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"EqvtAmt\": {\r\n                        \"Amt\": {\r\n                            \"Amt\": 50431891779910900,\r\n                            \"Ccy\": \"USD\"\r\n                        },\r\n                        \"CcyOfTrf\": \"USD\"\r\n                    }\r\n                },\r\n                \"ChrgBr\": \"DEBT\",\r\n                \"CdtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp002\"\r\n                        }\r\n                    }\r\n                },\r\n                \"Cdtr\": {\r\n                    \"Nm\": \"April Sam Adamson\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1923-04-26\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27782722305\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-782722305\"\r\n                    }\r\n                },\r\n                \"CdtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783564685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"MSISDN\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"April Adamson\"\r\n                },\r\n                \"Purp\": {\r\n                    \"Cd\": \"MP2P\"\r\n                },\r\n                \"RgltryRptg\": {\r\n                    \"Dtls\": {\r\n                        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                        \"Cd\": \"100\"\r\n                    }\r\n                },\r\n                \"RmtInf\": {\r\n                    \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                },\r\n                \"SplmtryData\": {\r\n                    \"Envlp\": {\r\n                        \"Doc\": {\r\n                            \"PyeeRcvAmt\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 4906747824834590.33,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrFee\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 49067478248345.9,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            },\r\n                            \"PyeeFinSvcsPrvdrComssn\": {\r\n                                \"Amt\": {\r\n                                    \"Amt\": 0,\r\n                                    \"Ccy\": \"USD\"\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"SplmtryData\": {\r\n            \"Envlp\": {\r\n                \"Doc\": {\r\n                    \"InitgPty\": {\r\n                        \"Glctn\": {\r\n                            \"Lat\": \"-3.1675\",\r\n                            \"Long\": \"39.059\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Pacs008",
			"item": [
				{
					"name": "Pacs 008 (AM-622) - Test 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Incoming & Outgoing messages match\", function () {\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.senderIdentityInStore).to.be.false;\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.CdtTrfTxInf.PmtId.EndToEndId).to.eq(\"5cb8a2db-5c32-41bb-ac27-2597125d50fd\");\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Test debtor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.CdtTrfTxInf.DbtrAcct.Id.Othr.Id).to.eq(\"af36cfd29dd05eb483358899055a552af93cd7ae36093832189e63dab1954e90\");\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.CdtTrfTxInf.DbtrAcct.Id.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"TxTp\": \"pacs.008.001.10\",\r\n  \"FIToFICstmrCdt\": {\r\n    \"GrpHdr\": {\r\n      \"MsgID\": \"ac152c90-f8a5-4c8c-b148-025fafd22b65\",\r\n      \"CreDtTm\": \"2021-11-03T07:24:46.000Z\",\r\n      \"NbOfTxs\": 1,\r\n      \"SttlmInf\": {\r\n        \"SttlmMtd\": \"CLRG\"\r\n      }\r\n    },\r\n    \"CdtTrfTxInf\": {\r\n      \"PmtId\": {\r\n        \"InstrId\": \"2f68ae16-467a-4ac4-ba32-eb518646aa1d\",\r\n        \"EndToEndId\": \"5cb8a2db-5c32-41bb-ac27-2597125d50fd\"\r\n      },\r\n      \"IntrBkSttlmAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"InstdAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"ChrgBr\": \"DEBT\",\r\n      \"ChrgsInf\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"157605510200862\",\r\n          \"Ccy\": \"USD\"\r\n        },\r\n        \"Agt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp001\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"InitgPty\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"Dbtr\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"DbtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"John Klein\"\r\n          }\r\n        }\r\n      },\r\n      \"DbtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp001\"\r\n          }\r\n        }\r\n      },\r\n      \"CdtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp002\"\r\n          }\r\n        }\r\n      },\r\n      \"Cdtr\": {\r\n        \"Nm\": \"Inge Harper Ford\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1970-01-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27824061596\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-824061596\"\r\n        }\r\n      },\r\n      \"CdtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"Inge Ford\"\r\n          }\r\n        }\r\n      },\r\n      \"Purp\": {\r\n        \"Cd\": \"MP2P\"\r\n      }\r\n    },\r\n    \"RgltryRptg\": {\r\n      \"Dtls\": {\r\n        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n        \"Cd\": \"100\"\r\n      }\r\n    },\r\n    \"RmtInf\": {\r\n      \"Ustrd\": \"Payment of USD 15760551020086200.57 from John to Inge\"\r\n    },\r\n    \"SplmtryData\": {\r\n      \"Envlp\": {\r\n        \"Doc\": {\r\n          \"Xprtn\": \"2021-11-03T07:29:42.000Z\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				},
				{
					"name": "Pacs 008 (AM-622) - Test 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Test creditor fields pseudonyms\", function () {\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.Id).to.eq(\"a8ff90b1690ec225f41cbfa8f1f7b859e70c30e6275a9302c3c19929b93a1a72\");\r",
									"    pm.expect(responseJson.FIToFICstmrCdt.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.SchmeNm.Prtry).to.eq(\"PSEUDO\");\r",
									"    pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"TxTp\": \"pacs.008.001.10\",\r\n  \"FIToFICstmrCdt\": {\r\n    \"GrpHdr\": {\r\n      \"MsgID\": \"ac152c90-f8a5-4c8c-b148-025fafd22b65\",\r\n      \"CreDtTm\": \"2021-11-03T07:24:46.000Z\",\r\n      \"NbOfTxs\": 1,\r\n      \"SttlmInf\": {\r\n        \"SttlmMtd\": \"CLRG\"\r\n      }\r\n    },\r\n    \"CdtTrfTxInf\": {\r\n      \"PmtId\": {\r\n        \"InstrId\": \"2f68ae16-467a-4ac4-ba32-eb518646aa1d\",\r\n        \"EndToEndId\": \"5cb8a2db-5c32-41bb-ac27-2597125d50fd\"\r\n      },\r\n      \"IntrBkSttlmAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"InstdAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"ChrgBr\": \"DEBT\",\r\n      \"ChrgsInf\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"157605510200862\",\r\n          \"Ccy\": \"USD\"\r\n        },\r\n        \"Agt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp001\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"InitgPty\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"Dbtr\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"DbtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"John Klein\"\r\n          }\r\n        }\r\n      },\r\n      \"DbtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp001\"\r\n          }\r\n        }\r\n      },\r\n      \"CdtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp002\"\r\n          }\r\n        }\r\n      },\r\n      \"Cdtr\": {\r\n        \"Nm\": \"Inge Harper Ford\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1970-01-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27824061596\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-824061596\"\r\n        }\r\n      },\r\n      \"CdtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"Inge Ford\"\r\n          }\r\n        }\r\n      },\r\n      \"Purp\": {\r\n        \"Cd\": \"MP2P\"\r\n      }\r\n    },\r\n    \"RgltryRptg\": {\r\n      \"Dtls\": {\r\n        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n        \"Cd\": \"100\"\r\n      }\r\n    },\r\n    \"RmtInf\": {\r\n      \"Ustrd\": \"Payment of USD 15760551020086200.57 from John to Inge\"\r\n    },\r\n    \"SplmtryData\": {\r\n      \"Envlp\": {\r\n        \"Doc\": {\r\n          \"Xprtn\": \"2021-11-03T07:29:42.000Z\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				},
				{
					"name": "Pacs 008 (AM-622) - Test 3",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().FIToFICstmrCdt.CdtTrfTxInf.DbtrAcct.Id.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    pm.test(`Check if debtor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									"\r",
									"pm.sendRequest({\r",
									"    url: 'http://arango.development:8529/_db/pseudonyms/_api/cursor',\r",
									"    method: 'POST',\r",
									"    header:{'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}`},\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR doc IN pseudonyms FILTER doc.pseudonym == '${pm.response.json().FIToFICstmrCdt.CdtTrfTxInf.Cdtr.Id.PrvtId.Othr.Id}' RETURN doc`\r",
									"        })\r",
									"    }\r",
									"}, function (err, res) {\r",
									"    pm.test(`Check if creditor pseudonym exists`, function () {\r",
									"        if (err)\r",
									"            pm.expect('Not an error').to.eq('An error occurred')\r",
									"        else {\r",
									"            const arangoRes = res.json();\r",
									"            if (arangoRes.error === true)\r",
									"                pm.expect('Not an error').to.eq(arangoRes.errorMessage)\r",
									"            else\r",
									"                pm.expect(arangoRes.result).to.length(1);\r",
									"        }\r",
									"    });\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"TxTp\": \"pacs.008.001.10\",\r\n  \"FIToFICstmrCdt\": {\r\n    \"GrpHdr\": {\r\n      \"MsgID\": \"ac152c90-f8a5-4c8c-b148-025fafd22b65\",\r\n      \"CreDtTm\": \"2021-11-03T07:24:46.000Z\",\r\n      \"NbOfTxs\": 1,\r\n      \"SttlmInf\": {\r\n        \"SttlmMtd\": \"CLRG\"\r\n      }\r\n    },\r\n    \"CdtTrfTxInf\": {\r\n      \"PmtId\": {\r\n        \"InstrId\": \"2f68ae16-467a-4ac4-ba32-eb518646aa1d\",\r\n        \"EndToEndId\": \"5cb8a2db-5c32-41bb-ac27-2597125d50fd\"\r\n      },\r\n      \"IntrBkSttlmAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"InstdAmt\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"15918156530287100\",\r\n          \"Ccy\": \"USD\"\r\n        }\r\n      },\r\n      \"ChrgBr\": \"DEBT\",\r\n      \"ChrgsInf\": {\r\n        \"Amt\": {\r\n          \"Amt\": \"157605510200862\",\r\n          \"Ccy\": \"USD\"\r\n        },\r\n        \"Agt\": {\r\n          \"FinInstnId\": {\r\n            \"ClrSysMmbId\": {\r\n              \"MmbId\": \"dfsp001\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"InitgPty\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"Dbtr\": {\r\n        \"Nm\": \"John Harper Klein\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1911-12-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27751185514\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-751185514\"\r\n        }\r\n      },\r\n      \"DbtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"John Klein\"\r\n          }\r\n        }\r\n      },\r\n      \"DbtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp001\"\r\n          }\r\n        }\r\n      },\r\n      \"CdtrAgt\": {\r\n        \"FinInstnId\": {\r\n          \"ClrSysMmbId\": {\r\n            \"MmbId\": \"dfsp002\"\r\n          }\r\n        }\r\n      },\r\n      \"Cdtr\": {\r\n        \"Nm\": \"Inge Harper Ford\",\r\n        \"Id\": {\r\n          \"PrvtId\": {\r\n            \"DtAndPlcOfBirth\": {\r\n              \"BirthDt\": \"1970-01-15\",\r\n              \"CityOfBirth\": \"Unknown\",\r\n              \"CtryOfBirth\": \"ZZ\"\r\n            },\r\n            \"Othr\": {\r\n              \"Id\": \"+27824061596\",\r\n              \"SchmeNm\": {\r\n                \"Prtry\": \"MSISDN\"\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"CtctDtls\": {\r\n          \"MobNb\": \"+27-824061596\"\r\n        }\r\n      },\r\n      \"CdtrAcct\": {\r\n        \"Id\": {\r\n          \"Othr\": {\r\n            \"Id\": \"+27751185514\",\r\n            \"SchmeNm\": {\r\n              \"Prtry\": \"MSISDN\"\r\n            },\r\n            \"Nm\": \"Inge Ford\"\r\n          }\r\n        }\r\n      },\r\n      \"Purp\": {\r\n        \"Cd\": \"MP2P\"\r\n      }\r\n    },\r\n    \"RgltryRptg\": {\r\n      \"Dtls\": {\r\n        \"Tp\": \"BALANCE OF PAYMENTS\",\r\n        \"Cd\": \"100\"\r\n      }\r\n    },\r\n    \"RmtInf\": {\r\n      \"Ustrd\": \"Payment of USD 15760551020086200.57 from John to Inge\"\r\n    },\r\n    \"SplmtryData\": {\r\n      \"Envlp\": {\r\n        \"Doc\": {\r\n          \"Xprtn\": \"2021-11-03T07:29:42.000Z\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://nifi.development:8081",
							"protocol": "http",
							"host": [
								"nifi",
								"development"
							],
							"port": "8081"
						}
					},
					"response": []
				}
			]
		}
	]
}